#!/bin/sh

cd $HOME
git clone git://github.com/sstephenson/rbenv.git ~/.rbenv

if [ -x `which rbenv` ];then
    mkdir -p ~/.rbenv/plugins
    cd ~/.rbenv/plugins
    git clone git://github.com/sstephenson/ruby-build.git
    git clone git://github.com/tpope/rbenv-ctags.git
    git clone git://github.com/jamis/rbenv-gemset.git

    echo 'export PATH="$HOME/.rbenv/bin/:$HOME/.rbenv:$PATH"' >> ~/.zshrc
    echo 'eval "$(rbenv init -)"' >> ~/.zshrc

    # 1.8.7
    CC=/usr/local/bin/gcc-4.2 CONFIGURE_OPTS="--without-tcl --without-tk --enable-shared --with-openssl-dir=/usr/local/opt/openssl" rbenv install 1.8.7-p371 &

    # 1.9.3
    CONFIGURE_OPTS="--with-openssl-dir=`brew --prefix openssl` --enable-shared" rbenv install 1.9.3-p392 &

    # 2.0.0
    CONFIGURE_OPTS="--with-openssl-dir=`brew --prefix openssl` --enable-shared" rbenv install 2.0.0-p195 &

    rbenv rehash
fi
exec $SHELL
